---
title: "Assingment 4"
author: "Samuel Kelly"
date: '`r format(Sys.Date(),format="%A, %B %d, %Y")`'
output: 
  html_document:
    df_print: paged
    fig_caption: true
    highlights: pygments
    number_sections: no
    theme: spacelab
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 4/10

# WD

```{r}
getwd()
```


# 1. MS 7.118 - pg 364

116 bird species, measured were body mass(g), egg length(mm)

## a.

```{r}
nzbird=read.csv("NZBIRDS.csv")
head(nzbird)
set.seed(50)
sam=nzbird[sample(1:nrow(nzbird),size = 35),]
```

## b.

Body mass

```{r}
mean(sam$Body.Mass)
sd(sam$Body.Mass)
t.test(x = nzbird$Body.Mass,conf.level = .95,mu = 6680.371)$conf.int
```

## c.

We accept our null hypothesis that the mean of our sample, 6680.371g, is in the confidence interval of (3208.217, 13397.434), since 6680.371 is in this interval.

## d.

The true mean of 9113g is in the interval (3208.217, 13397.434). The confidence level we have chosen is alpha=.05, or 95% confidence, and since 95% covers most of the data set, we can be fairly certain that the true mean lies in the interval.

## e.

Egg length

```{r}
mean(sam$Egg.Length,na.rm = T)
sd(sam$Egg.Length,na.rm = T)
t.test(x = nzbird$Egg.Length,conf.level = .95,mu = 55.5303)$conf.int
```

We accept the null hypothesis that 55.5303 is in the interval (53.02102, 68.28667).
61.06 is also in our interval, and since we cover 95% of the data we can be fairly certain that the true mean lies n the interval.

## f.

```{r}
flight_extinct=21/38
flight_alive=7/78
z=qnorm(1-.05/2)
np=38*flight_extinct
np>=4
nq=38*(1-flight_extinct)
nq>=4
np2=78*flight_alive
np2>=4
nq2=78*(1-flight_alive)
nq2>=4
```

Since our approximations are greater than or equal to 4, than we can use CLT.

```{r}
mp=c(-1,1)
(flight_extinct-flight_alive)+mp*z*sqrt((flight_extinct*(1-flight_extinct))/38+(flight_alive*(1-flight_alive))/78)
```

Our 95% ci is (0.2925475, 0.6332285).

## g.

Yes, we 95% confident that 21/38=.5526 lies in the interval while 7/78=.0897 does not, so the proportion of extinct birds is higher.

# 2. MS 7.120 - pg 365

## a.

n1=100, n2=47 are both greater than 30, so we know which 2-sample formula to use.
$$(\bar{y_1}-\bar{y_2})\pm z_{\frac{\alpha}{2}}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}$$

```{r}
(1312-1352)+mp*qnorm(1-.1/2)*sqrt((422^2)/100+(271^2)/47)
```


## b.

$$(\frac{s_1^2}{s_2^2})\frac{1}{F_{\alpha/2(\nu_1,\nu_2)}}\leq \frac{\sigma_1^2}{\sigma_2^2}\leq (\frac{s_1^2}{s_2^2})F_{\alpha/2(\nu_2,\nu_1)}$$

```{r}
f1=qf(1-.1/2,df1 = 99,df2 = 46)
f2=qf(1-.1/2,df1 = 46,df2 = 99)
l=(422^2)/271^2*(1/f1)
u=(422^2)/271^2*(f2)
ci=c(l,u)
ci
```

We can say that the variances do indeed differ as 1 is not in the interval (1.566267, 3.617750).

# 3. MS 7.128 - pg 367

## a.



## b.



# 4. MS 8.24 - pg 390

## a.

The Null Hypothesis is mu=2, the alternative hypothesis is that mu!=2.

## b.

The t statistic is -1.02, and the p-value is .322

## c.

```{r}
qt(1-.05/2,df = 19)
```


We reject when the t statistic falls in the interval (-infinity,-2.093024)U(2.093024,infinity)

## d.

We accept mu=2 as a possible value. Not only does t lie in the ci, but our p-value is greater than alpha, .322>.05.

## e.

Since our test statistic t lies in the 95% ci, then we can conclude that we are fairly certain our mean lies in the interval.

# 5. MS 8.28 - pg 392

## a.

```{r}
lake=c(9.6,4.5,13.2,4.1,22.6,2.7,14.7,3.5,13.6,19.8,14.3,56.9,25.1,18.4,2.7,4.2,30.2,10.3,17.6,2.4,17.3,38.8,3.0,5.8,7.6)
t.test(x = lake,mu = 15,conf.level = .9)
```

With the t test we can see that our p-value is .8535>.1 so we can accept our null hypothesis, and since the estimate mean is 14.516, we can say that this sample may closely reflect all of Wisconsin.

## b.

$$t=\frac{\bar{y}-\mu_0}{s/\sqrt n}\Rightarrow \bar{y}=t\frac{s}{\sqrt n}+\mu_0$$

```{r}
s=sd(lake)
t=qt(1-.1/2,df = 24)
mu=15
ci=mp*t*(s/sqrt(25))+mu
ci
```

We would reject the null if mu fell into the region (-infinity,10.56413)U(19.43587,infinity).
So the probability that t will lie in that region is:
```{r}
pt((10.56413-14)/(s/sqrt(25)),df = 24) + (1-pt((19.43587-14)/(s/sqrt(25)),df = 24))
```
The probability that t will be in the rejection region is: 12.21687%.

# 6. MS 8.44 - pg 401



# 7. MS 8.84 - pg 425 â€“ This refers to 8.39 NOT 8.33!



# 8. MS 8.99 - pg 438



# 9. MS 8.104 - pg 439



# 10. Plot


