---
title: "Lab 11"
author: "Samuel Kelly"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Task 1

```{r}
getwd()
```


# Task 2

## Diameter of washers (cm)

```{r}
d=c(5.0581, 4.9707, 5.0893, 4.9334, 4.9777, 5.0285, 4.8555, 4.9565, 
4.9769, 4.9722, 4.999, 4.9925, 4.9686, 5.0662, 4.9239, 4.9781, 
5.0485, 5.0014, 4.9957, 5.0195, 5.0118, 4.9928, 5.0361, 5.0185, 
4.9879)
```

## 95% ci mean

```{r}
t.test(x = d,conf.level = .95)$conf.int
t=qt(1-.05/2,df = length(d) - 1)
mp <- c(-1,1)
ci <- mean(d)+mp*t*sd(d)/sqrt(length(d))
ci
```

## 90% ci mean

```{r}
t.test(x = d,conf.level = .90)$conf.int
t=qt(1-.1/2,df = length(d) - 1)
mp <- c(-1,1)
ci <- mean(d)+mp*t*sd(d)/sqrt(length(d))
ci
```

## 80% ci mean

```{r}
t.test(x = d,conf.level = .80)$conf.int
t=qt(1-.2/2,df = length(d) - 1)
mp <- c(-1,1)
ci <- mean(d)+mp*t*sd(d)/sqrt(length(d))
ci
```

As we can see through t.test, the values between what we calculated and what R calculated are exactly the same.

## 50% ci mean

```{r}
t.test(x = d,conf.level = .5)$conf.int
t=qt(1-.5/2,df = length(d) - 1)
mp <- c(-1,1)
ci <- mean(d)+mp*t*sd(d)/sqrt(length(d))
ci
```

## 95% ci standard deviation

```{r}
chisq1=qchisq(1-.05/2,df = length(d)-1)
chisq2=qchisq(.05/2,df = length(d)-1)
ci=c()
ci[1]<-(length(d)-1)*var(d)/chisq1
ci[2]<-(length(d)-1)*var(d)/chisq2
ci
```

## 90% ci standard deviation

```{r}
chisq1=qchisq(1-.1/2,df = length(d)-1)
chisq2=qchisq(.1/2,df = length(d)-1)
ci=c()
ci[1]<-(length(d)-1)*var(d)/chisq1
ci[2]<-(length(d)-1)*var(d)/chisq2
ci
```

## 80% ci standard deviation

```{r}
chisq1=qchisq(1-.2/2,df = length(d)-1)
chisq2=qchisq(.2/2,df = length(d)-1)
ci=c()
ci[1]<-(length(d)-1)*var(d)/chisq1
ci[2]<-(length(d)-1)*var(d)/chisq2
ci
```

## 50% ci standard deviation

```{r}
chisq1=qchisq(1-.5/2,df = length(d)-1)
chisq2=qchisq(.5/2,df = length(d)-1)
ci=c()
ci[1]<-(length(d)-1)*var(d)/chisq1
ci[2]<-(length(d)-1)*var(d)/chisq2
ci
```

# Task 3

## Blue cod fish

```{r}
blue=c(21.65, 17.48, 20.1, 21.57, 14.82, 19.17, 21.08, 18.23, 22.93, 
15.66, 20.89, 21.66, 18.5, 20.59, 18.63, 18.91, 19.53, 17.7, 16.5, 19.03)
```

## Snapper

```{r}
snapper=c(31.65, 27.48, 30.1, 31.57, 24.82, 29.17, 31.08, 28.23, 32.93, 25.66, 30.89, 31.66, 28.5, 30.59, 28.63)
```

## z vs. t

Use t for small populations, i.e. n < 30, if both populations are greater than 30, use z.

## 95% ci for blue - snapper

```{r}
t.test(x = blue,y = snapper,conf.level = .95,var.equal = T,paired = F)$conf.int
spsq=((length(blue)-1)*var(blue)+(length(snapper)-1)*var(snapper))/(length(blue)+length(snapper)-2)
t=qt(1-.05/2,df = length(blue)+length(snapper)-2)
mp<-c(-1,1)
ci<-mean(blue)-mean(snapper)+mp*t*sqrt(spsq*(1/length(blue)+1/length(snapper)))
ci
```

## 95% ci for snapper - blue

```{r}
t.test(x = snapper,y = blue,conf.level = .95,var.equal = T,paired = F)$conf.int
spsq=((length(snapper)-1)*var(snapper)+(length(blue)-1)*var(blue))/(length(snapper)+length(blue)-2)
t=qt(1-.05/2,df = length(snapper)+length(blue)-2)
mp<-c(-1,1)
ci<-mean(snapper)-mean(blue)+mp*t*sqrt(spsq*(1/length(snapper)+1/length(blue)))
ci
```

The estimated interval for where the mean lies in the difference of the means of the two sample populations lies in the range of 8.76 to 11.84. So we can say the mean difference in size between snappers and cods is between 8.76 to 11.84.

## t.test

```{r}
t.test(x = snapper,y = blue,conf.level = .95,var.equal = T)$conf.int
t.test(x = snapper,y = blue,conf.level = .85,var.equal = T)$conf.int
t.test(x = snapper,y = blue,conf.level = .75,var.equal = T)$conf.int
t.test(x = snapper,y = blue,conf.level = .25,var.equal = T)$conf.int
```

Our estimate on the interval gets smaller. This comes naturally from the fact that as our confidence level decreases, so to does our value of t, and since we multiply by t in our estimate formula, then the smaller t becomes, the smaller our interval.

# Task 4



# Task 5



# Task 6



# Task 7

```{r}
set.seed(23);x = rnorm(30,mean=10,sd=12)
t.test(x = x,conf.level = .95)$conf.int
MATH4753Kelly::myci(x)
```

